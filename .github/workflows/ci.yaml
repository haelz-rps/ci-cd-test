name: CI

on: 
  push:
    paths:
      - connectors/**

jobs:
  changed_files:
    runs-on: ubuntu-latest
    name: Test changed-files
    steps:
      - uses: actions/checkout@v4

      - name: Get changed files
        id: changed-files
        uses: tj-actions/changed-files@v45

      # - name: List all changed files
      #   env:
      #     ALL_CHANGED_FILES: ${{ steps.changed-files.outputs.all_changed_files }}
      #   run: |
      #     for file in ${ALL_CHANGED_FILES}; do
      #       echo "$file was changed"
      #     done

      - name: Get list of changed files
        id: changes
        run: |
          # Captura os arquivos modificados
          git diff --name-only ${{ github.event.before }} ${{ github.sha }} > changed_files.txt
          # Extraindo apenas o nome entre as barras (diretório base)
          dir=$(awk -F'/' '{print $2}' changed_files.txt | sort | uniq)
          echo "{dir}={$dir}" >> $GITHUB_ENV
      - name: Show changed directories or files
        run: |
          echo "Arquivos ou diretórios alterados:"
          echo "${{ env.dir }}"
